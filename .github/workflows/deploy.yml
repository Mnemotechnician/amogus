name: Amogus

on: [push]

jobs:
  goToSecurity:
      name: 'Cancel Other Workflow'
      runs-on: ubuntu-latest
      steps:
        - name: Make others leave the security room
          uses: styfle/cancel-workflow-action@0.9.0
          with:
            access_token: ${{ github.token }}
  
  emergencyMetting:
    runs-on: ubuntu-latest
    
    steps:
      - name: Find the impostor via the security room
        uses: actions/checkout@v2
        
      - name: Run to the cafeteria
        run: export COLUMNS
      
      - name: Press the red button in cafeteria
        uses: fwilhe2/setup-kotlin@main
        
      - name: Provide the evidence
        run: chmod +x ./gradlew
        
      - name: Eject them from the ship!
        run: ./gradlew deploy; java -jar ./build/app.jar ${{ secrets.WEBHOOK }} false 2500